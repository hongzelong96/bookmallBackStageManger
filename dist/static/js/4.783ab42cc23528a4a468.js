webpackJsonp([4],{"/EyW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"addproduct",components:{editProduct:a("V/YH").a}},i={render:function(){var e=this.$createElement;return(this._self._c||e)("edit-product",{attrs:{isUpdate:!1}})},staticRenderFns:[]};var n=a("VU/8")(r,i,!1,function(e){a("avi4")},null,null);t.default=n.exports},"9bBU":function(e,t,a){a("mClu");var r=a("FeBl").Object;e.exports=function(e,t,a){return r.defineProperty(e,t,a)}},C4MV:function(e,t,a){e.exports={default:a("9bBU"),__esModule:!0}},"V/YH":function(e,t,a){"use strict";var r,i=a("woOf"),n=a.n(i),o=a("bOdI"),s=a.n(o),c=a("UgCr"),u={name:"editProductInfo",data:function(){return{rules:{name:[{required:!0,message:"请输入书本名称",trigger:"blur"}],author:[{required:!0,message:"请输入作者名称",trigger:"blur"}],price:[{required:!0,message:"请输入定价",trigger:"blur"}]},valdata:{}}},props:{value:Object,isUpdate:{type:Boolean,default:!1}},methods:{HandlerNextPage:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({message:"验证失败",type:"error",duration:1e3}),!1;t.$emit("nextStep")})},HandleChange:function(){}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"infoForm",attrs:{model:e.value,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"书名",prop:"name"}},[a("el-input",{model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{model:{value:e.value.author,callback:function(t){e.$set(e.value,"author",t)},expression:"value.author"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.value.price,callback:function(t){e.$set(e.value,"price",t)},expression:"value.price"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"20px"}},[e._v("元")])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.value.description,callback:function(t){e.$set(e.value,"description",t)},expression:"value.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"入库数量",prop:"storage"}},[a("el-input",{model:{value:e.value.storage,callback:function(t){e.$set(e.value,"storage",t)},expression:"value.storage"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类别分类",prop:"category"}},[a("el-cascader",{attrs:{options:e.value.productCateOptions,props:{expandTrigger:"hover"}},on:{change:e.HandleChange},model:{value:e.value.categoryId,callback:function(t){e.$set(e.value,"categoryId",t)},expression:"value.categoryId"}})],1),e._v(" "),a("el-form-item",[a("el-button-group",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.HandlerNextPage("infoForm")}}},[e._v("下一页 添加商品图片"),a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)],1)},staticRenderFns:[]},d=a("VU/8")(u,l,!1,null,null,null).exports,p={name:"editProductPic",data:function(){return{dialogImageUrl:"",dialogVisible:!1,disabled:!1}},props:{value:Object,isUpdate:{type:Boolean,default:!1},picId:String},computed:{picture_id:function(){return{pictureId:this.picId}}},methods:{HandlerBack:function(){this.$emit("LastStep")},HandlerUpdate:function(){this.$emit("finishUpdate")},beforeRemove:function(e,t){return this.$confirm("确定删除此图片")},handleRemove:function(e,t){var a=this;Object(c.a)(e.url).then(function(e){(e.msg="delete success")?a.$message({message:"删除成功",type:"success"}):a.$message.error("删除失败！")})},handlePreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e){console.log(e)}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.value,"label-width":"120px"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"http://localhost:3000/uploadPic","on-preview":e.handlePreview,"before-remove":e.beforeRemove,"on-remove":e.handleRemove,"file-list":e.value.PicList,"on-success":e.handleSuccess,data:e.picture_id,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-form-item",[a("el-button-group",[a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:e.HandlerBack}},[e._v("返回 商品信息")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.HandlerUpdate}},[e._v("修改提交"),a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},h=a("VU/8")(p,m,!1,null,null,null).exports,f=(r={id:"",name:"",description:"",storage:0,author:"",price:0,hot:0,public:0,categoryId:0,pictureId:"0",productCateOptions:[]},s()(r,"categoryId",0),s()(r,"PicList",[]),r),v={name:"editProduct",data:function(){return{active:0,productParam:n()({},f),Status:[!0,!1],hasUpdate:!1}},components:{editProductInfo:d,editProductPic:h},props:{isUpdate:{type:Boolean,default:!1}},watch:{isUpdate:function(e){console.log("is update",e)},$route:function(e,t){console.log("to",e,"from",t)}},created:function(){var e=this;if(this.isUpdate){var t={BookId:this.$route.query.id};Object(c.c)(t).then(function(t){return e.matchData(t)}).then(function(){return Object(c.i)()}).then(function(t){return e.getCategoryList(t)}).then(function(){return Object(c.j)({BookId:e.productParam.pictureId})}).then(function(t){return e.getPicArray(t)}).catch(function(e){return console.log(e)})}else Object(c.i)().then(function(t){return e.getCategoryList(t)})},methods:{hideAll:function(){for(var e=0;e<this.Status.length;e++)this.Status[e]=!1},matchData:function(e){var t=e.bookDetail[0];this.productParam.pictureId=t.pictureId,this.productParam.id=t.id,this.productParam.name=t.name,this.productParam.description=t.description,this.productParam.storage=t.storage,this.productParam.author=t.author,this.productParam.price=t.price,this.productParam.hot=t.hot,this.productParam.public=t.public,this.productParam.categoryId=t.categoryId},getCategoryList:function(e){this.productParam.productCateOptions=[];for(var t=e.categoryList,a=0;a<t.length;a++)if(0==t[a].parentId){var r={label:t[a].name,value:t[a].id,children:[]};this.productParam.productCateOptions.push(r);for(var i=0;i<t.length;i++)if(t[i].parentId==t[a].id){var n={label:t[i].name,value:t[i].id};r.children.push(n)}}},getPicArray:function(e){this.productParam.PicList=e.picArray},nextStep:function(){var e=this;this.isUpdate?Object(c.l)(this.productParam).then(function(){return e.$message({message:"修改成功",type:"success"})},this.hasUpdate=!0):Object(c.k)(this.productParam).then(function(t){e.productParam.pictureId=t.id,console.log("新的一本书pictureid",e.productParam.pictureId)}).then(function(){e.$message({message:"修改成功",type:"success"})}),this.active<this.Status.length-1&&(this.active++,this.hideAll(),this.Status[this.active]=!0)},LastStep:function(){this.active>0&&(this.active--,this.hideAll(),this.Status[this.active]=!0)},handlerUpdate:function(){this.hasUpdate=!0,this.$router.push({path:"/productCenter/productList",query:{hasUpdate:this.hasUpdate}})}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"form-container",attrs:{shadow:"never"}},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"填写商品信息"}}),e._v(" "),a("el-step",{attrs:{title:"上传商品图片"}})],1),e._v(" "),a("edit-product-info",{directives:[{name:"show",rawName:"v-show",value:e.Status[0],expression:"Status[0]"}],attrs:{isUpdate:e.isUpdate},on:{nextStep:e.nextStep},model:{value:e.productParam,callback:function(t){e.productParam=t},expression:"productParam"}}),e._v(" "),a("edit-product-pic",{directives:[{name:"show",rawName:"v-show",value:e.Status[1],expression:"Status[1]"}],attrs:{picId:e.productParam.pictureId,isUpdate:e.isUpdate},on:{LastStep:e.LastStep,finishUpdate:e.handlerUpdate},model:{value:e.productParam,callback:function(t){e.productParam=t},expression:"productParam"}})],1)},staticRenderFns:[]};var b=a("VU/8")(v,g,!1,function(e){a("eMmm")},null,null);t.a=b.exports},avi4:function(e,t){},bOdI:function(e,t,a){"use strict";t.__esModule=!0;var r,i=a("C4MV"),n=(r=i)&&r.__esModule?r:{default:r};t.default=function(e,t,a){return t in e?(0,n.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},eMmm:function(e,t){},mClu:function(e,t,a){var r=a("kM2E");r(r.S+r.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})}});
//# sourceMappingURL=4.783ab42cc23528a4a468.js.map