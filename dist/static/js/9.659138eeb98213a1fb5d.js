webpackJsonp([9],{b7xY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("UgCr"),n={data:function(){return{index:0,dialogVisible:!1,disabled:!1}},props:{picArr:{default:!0}},methods:{lastPic:function(){this.index--,this.index<0&&(console.log("<0"),this.index=this.picArr.length-1),console.log("index:",this.index)},nextPic:function(){this.index++,this.index==this.picArr.length&&(this.index=0),console.log("index:",this.index)},handlePreview:function(e){this.dialogImageUrl=e,this.dialogVisible=!0}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"picContainer"},[a("img",{staticClass:"picbody",attrs:{src:e.picArr[e.index].url,lazy:"true"},on:{click:function(t){return e.handlePreview(e.picArr[e.index].url)}}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:e.lastPic}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-right"},on:{click:e.nextPic}}),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"dialog"},[a("el-button",{staticClass:"picbutton",attrs:{visible:e.dialogVisible,type:"primary",icon:"el-icon-arrow-left",circle:""},on:{"update:visible":function(t){e.dialogVisible=t},click:e.lastPic}}),e._v(" "),a("img",{staticClass:"pic",attrs:{width:"100%",src:e.picArr[e.index].url,alt:""}}),e._v(" "),a("el-button",{staticClass:"picbutton",attrs:{visible:e.dialogVisible,type:"primary",icon:"el-icon-arrow-right",circle:""},on:{"update:visible":function(t){e.dialogVisible=t},click:e.nextPic}})],1)])],1)},staticRenderFns:[]};var s={components:{pictureForList:a("VU/8")(n,r,!1,function(e){a("g/3v")},"data-v-bdebe4ec",null).exports},name:"productList",data:function(){return{paginations:{pageIndex:1,pageSize:10,pageSizes:[10,15,20,30],layout:"total, sizes, prev, pager, next, jumper"},resdata:[],tableData:[],loading:!0,listTotal:0,showPic:!0,form:{},isHot:!0,isPublic:!0,currentSearchType:"none",sreachOption:[{value:"name",label:"书名搜索"},{value:"author",label:"作者名搜索"}],searchQuery:{searchway:"",searchInfo:""},scrollTop:0}},created:function(){if(this.$route.query.categoryId){console.log("req bycategoryId"),this.searchQuery.searchInfo=this.$route.query.categoryId;var e={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize,searchInfo:this.$route.query.categoryId};this.currentSearchType="category",this.handleReq(e,"category")}else{console.log("normal req");var t={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize};this.handleReq(t,"none")}},mounted:function(){var e=this;this.$refs.mytable.bodyWrapper.addEventListener("scroll",function(t){var a=t.target;e.scrollTop=a.scrollTop},!1)},beforeDestroy:function(){var e=this;console.log("beforeDestory"),this.$refs.table.bodyWrapper.removeEventListener("scroll",function(t){var a=t.target;e.scrollTop=a.scrollTop},!1)},activated:function(){this.$route.query.update&&console.log("成功更新",this.$route.query),this.$nextTick(function(){console.log("!!!!");var e=this.$el.querySelector(".el-table__body-wrapper");e.scrollTop=this.$store.getters.scroll_top,console.log("scrollTop.scrollTop",e.scrollTop)})},watch:{resdata:function(e){this.tableData=e}},beforeRouteLeave:function(e,t,a){"/productCenter/updateProduct"==e.path?(t.meta.keepAlive=!0,this.$store.commit("SAVE_SCROLL",this.scrollTop)):t.meta.keepAlive=!1,a()},methods:{handleReq:function(e,t){var a=this;switch(this.loading=!0,t){case"name":Object(i.g)(e).then(function(e){return a.handleRes(e)}).catch(function(e){console.log(e)});break;case"author":Object(i.e)(e).then(function(e){return a.handleRes(e)}).catch(function(e){console.log(e)});break;case"none":Object(i.d)(e).then(function(e){return a.handleRes(e)}).catch(function(e){console.log(e)});break;case"default":Object(i.h)(e).then(function(e){return a.handleRes(e)}).catch(function(e){console.log(e)});break;case"category":Object(i.f)(e).then(function(e){return a.handleRes(e)}).catch(function(e){console.log(e)})}},handleRes:function(e){var t=this;this.listTotal=e.count,this.resdata=e.booklist,setTimeout(function(){t.loading=!1},500)},handleSearch:function(){if("默认"!=this.searchQuery.searchway&&""==this.searchQuery.searchInfo)this.$message.error("搜索条件和关键词不能为空！！！");else{this.paginations.pageIndex=1;var e={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize,searchway:this.searchQuery.searchway,searchInfo:this.searchQuery.searchInfo};this.handleReq(e,this.searchQuery.searchway),this.currentSearchType=this.searchQuery.searchway}},HandlerUpdate:function(e){this.$router.push({path:"updateProduct",query:{id:e}})},handleReset:function(){var e={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize};this.handleReq(e,"none"),this.currentSearchType="none"},handleClean:function(){this.searchQuery.searchway="",this.searchQuery.searchInfo=""},handleSizeChange:function(e){this.paginations.pageSize=e,this.paginations.pageIndex=1;var t={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize,searchway:this.searchQuery.searchway,searchInfo:this.searchQuery.searchInfo};this.handleReq(t,this.currentSearchType)},handleCurrentChange:function(e){this.paginations.pageIndex=e;var t={pageindex:this.paginations.pageIndex-1,pagesize:this.paginations.pageSize,searchway:this.searchQuery.searchway,searchInfo:this.searchQuery.searchInfo};this.handleReq(t,this.currentSearchType)},HandlerDelet:function(e){var t=this;Object(i.b)({id:e}).then(function(a){a.msg.includes("success")&&t.$message({message:"删除成功",type:"success"}),console.log(a.msg.includes("success"));var i=-1;for(var n in t.tableData)if(t.tableData[n].id==e){i=n;break}-1!=i&&t.tableData.splice(i,1)})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{attrs:{shadow:"never"}},[a("div",[a("i"),e._v(" "),a("span",[e._v("筛选搜索")]),e._v(" "),a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"搜索方式："}},[a("el-select",{staticStyle:{width:"20px,margin-bottom:15px"},attrs:{placeholder:"关键词",clearable:""},model:{value:e.searchQuery.searchway,callback:function(t){e.$set(e.searchQuery,"searchway",t)},expression:"searchQuery.searchway"}},e._l(e.sreachOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{staticStyle:{width:"30%"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch()}},model:{value:e.searchQuery.searchInfo,callback:function(t){e.$set(e.searchQuery,"searchInfo",t)},expression:"searchQuery.searchInfo"}}),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearch()}}},[e._v("\n            查询\n          ")]),e._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){return e.handleReset()}}},[e._v("默认列表")]),e._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){return e.handleClean()}}},[e._v("\n            重置条件\n          ")])],1)],1)],1)]),e._v(" "),a("div",{staticStyle:{"min-width":"1425px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mytable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"","highlight-current-row":"",height:"700px"}},[a("el-table-column",{directives:[{name:"show",rawName:"v-show",value:e.showPic,expression:"showPic"}],attrs:{prop:"img",label:"img",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("picture-for-list",{attrs:{picArr:e.row.pictureArr}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"id",label:"id",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"name",label:"书名",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"author",label:"作者",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"storage",label:"库存",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"price",label:"价格",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"label",label:"标签",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[a("el-switch",{attrs:{"active-text":"热销"},model:{value:t.row.hot,callback:function(a){e.$set(t.row,"hot",a)},expression:"scope.row.hot"}})],1),e._v(" "),a("p",[a("el-switch",{attrs:{"active-text":"上架"},model:{value:t.row.public,callback:function(a){e.$set(t.row,"public",a)},expression:"scope.row.public"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"description",label:"描述",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{on:{click:function(a){return e.HandlerUpdate(t.row.id)}}},[e._v("修改 ")]),e._v(" "),a("el-button",{on:{click:function(a){return e.HandlerDelet(t.row.id)}}},[e._v(" 删除 ")])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.paginations.pageIndex,"page-sizes":e.paginations.pageSizes,"page-size":e.paginations.pageSize,layout:e.paginations.layout,total:e.listTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,o,!1,function(e){a("vsRU")},null,null);t.default=l.exports},"g/3v":function(e,t){},vsRU:function(e,t){}});
//# sourceMappingURL=9.659138eeb98213a1fb5d.js.map